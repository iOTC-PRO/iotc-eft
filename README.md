# iotc-eft
iOTC与币币交易所用户资金一键快速划转通道

### 1. 简介
为实现用户资金在iOTC场外交易所和币币交易所之间快速来回划转，通过采用第三方Mixin钱包进行中转，即iOTC场外交易所和币币交易所各自在Mixin上开设一个公司账户，并且充值一部分备用金，当用户进行资金划转时，直接通过公司账户来进行结算，从而实现用户资金的快速划转，具体实现流程请参考以下说明。

### 2. 实现流程介绍
快速划转通道具体实现流程如下：

#### 2.1 用户在iOTC场外交易所一键划转到币币交易所<br/>
a、用户在iOTC场外交易所页面发起一键划转(在对应的币币交易所网站下)；<br/>
b、iOTC场外交易所根据用户请求，通过Mixin中转，从iOTC在Mixin上的公司账户转账给币币交易所在Mixin上开设的公司账户，在转账记录中包含对应用户的信息（为加密信息），Mixin上转账成功后，iOTC将对用户在场外交易所的资金进行扣减；<br/>
c、币币交易所从Mixin上定时获取转账记录，收到转账记录后，解密出用户信息，根据用户信息对用户在币币交易所中的账户进行资金增加，即完成此次划转。

#### 2.2 用户在币币交易所一键划转到iOTC场外交易所<br/>
a、用户在币币交易所页面发起一键划转；<br/>
b、币币交易所根据用户请求，通过Mixin中转，从币币交易所在Mixin上的公司账户转账给iOTC场外交易所在Mixin上开设的公司账户，在转账记录中包含对应用户的信息（为加密信息），Mixin上转账成功后，币币交易所即可对用户在币币交易所的资金进行扣减；<br/>
c、iOTC交易所从Mixin上定时获取转账记录，收到转账记录后，解密出用户信息，根据用户信息对用户在iOTC场外交易所中的账户进行资金增加，即完成此次划转。<br/>
注：币币交易所进行对账时只需拉取Mixin上的转账记录和在Mixin上的资金总额进行计算核对即可。

### 3. 对接流程介绍
a、币币交易所先在Mixin钱包上开设一个钱包账户，即Mixin上的机器人账户，在开设过程中会有账户私钥等信息，币币自行保管，建议币币交易所在使用账户私钥时，以加密方式缓存到项目内存中，不在项目中存储，提供加密接口，在项目部署过程中由CEO动态输入；<br/>
b、iOTC以加密邮件给币币发送一公钥和一私钥，公钥用于解密信息，私钥用于签名和加密信息；<br/>
c、将此EFT项目部署到内部服务器，并设置入口出口和入口网关（只出不进）及内网访问IP,提高安全性（此项目采用Java语言封装了和Mixin交易的所有流程，直接部署即可使用，此版本仅支持单点部署，如果开发语言和币币语言不一样，币币可自行考虑开发整套划转流程）；<br/>
d、币币交易所开发一键划转逻辑(从币币划转到iOTC)，在币币项目中调用如上部署的EFT服务转账接口，返回成功状态即为成功划转，在调用过程中iOTC给予的私钥对用户信息进行加密,iOTC获取到后会以公钥进行解密；<br/>
e、币币交易所开发定时拉取Mixin转账记录功能，在定时项目中定时调用如上部署的EFT项目拉取记录接口，拉取到转账记录后,采用iOTC给予的公钥进行解密用户信息，并对用户在币币上的资金进行增加（注：Mixin的转账记录采用的是倒排拉取的方式，如指定一个时间点2018-08-28，拉取100条，这100条记录为2018-08-28以前的记录）。
